datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}
model Application {
  id        String            @id @default(uuid())
  
  // User applying
  user      User              @relation(fields: [userId], references: [id])
  userId    String

  // Job applied to
  job       Job               @relation(fields: [jobId], references: [id])
  jobId     String

  status    ApplicationStatus @default(PENDING)
  createdAt DateTime          @default(now())
}

enum ApplicationStatus {
  PENDING
  ACCEPTED
  REJECTED
}

model Company {
  id          String   @id @default(uuid())
  name        String
  website     String?
  description String?
  location    String?

  employees   User[]   @relation("EmployeeCompany")

  recruiter   User?    @relation("CompanyRecruiter", fields: [recruiterId], references: [id])
  recruiterId String?  @unique

  jobs        Job[]
  createdAt   DateTime @default(now())
}

model Job {
  id          String   @id @default(uuid())
  title       String
  description String
  location    String

  // Company posting the job
  company     Company  @relation(fields: [companyId], references: [id])
  companyId   String

  // Applications for this job
  applications Application[]

  createdAt   DateTime @default(now())
}model User {
  id           String   @id @default(uuid())
  name         String
  email        String   @unique
  password     String
  role         Role     @default(EMPLOYEE)
  profileImage String?
  bio          String?
  
  // Employee relationship: which company they work for (if any)
  company      Company? @relation("EmployeeCompany", fields: [companyId], references: [id])
  companyId    String?

  // Recruiter relationship: which company they manage (if any)
  recruiterFor Company? @relation("CompanyRecruiter")

  // Jobs applied to
  applications Application[]

  createdAt    DateTime @default(now())
}



enum Role { 
  EMPLOYEE
  RECRUITER
}
